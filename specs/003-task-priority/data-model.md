# Модель данных: Приоритет задачи (003-task-priority)

**Фича**: 003-task-priority  
**Дата**: 2026-02-17  
**Основа**: расширение модели из 001-todo-list (Task, TodoList).

---

## Расширение сущности Task

Добавляется поле приоритета и правила его использования.

| Поле      | Тип     | Обязательное | Описание |
|-----------|---------|--------------|----------|
| priority  | string  | да           | Один из: `'Low'`, `'Medium'`, `'High'`. По умолчанию для новых задач: `'Medium'`. При загрузке старых записей без поля — подставлять `'Medium'`. |

**Правила**:
- При создании задачи: `priority = 'Medium'` (если не задано иное).
- При смене приоритета: задача перемещается в конец новой группы приоритета (пересчёт `order` среди задач с новым приоритетом).
- Валидация: допустимы только значения `'Low'`, `'Medium'`, `'High'`; при невалидном значении при загрузке — считать `'Medium'`.

**Порядок отображения**:
1. Сначала по приоритету: High, затем Medium, затем Low (фиксированный порядок уровней).
2. Внутри одной группы приоритета — по полю `order` по возрастанию (меньше = выше в списке).

---

## Группы приоритета и перетаскивание

- **Группа приоритета**: подмножество задач с одинаковым значением `priority`. В UI отображаются три группы (High, Medium, Low); внутри каждой — свой порядок по `order`.
- **Перетаскивание**: разрешено только внутри одной группы. При перетаскивании вызывается пересчёт `order` только среди задач этой группы; сохранение в localStorage — как в 001 (весь массив задач).

---

## Визуальное отображение (контракт для UI)

- Карточка задачи окрашивается в еле уловимый цвет по приоритету:
  - **High** — красный (red), пастельный/приглушённый оттенок.
  - **Medium** — жёлтый (yellow), пастельный/приглушённый оттенок.
  - **Low** — синий (blue), пастельный/приглушённый оттенок.
- Редактирование приоритета: по клику на отображаемое значение открывается лёгкий выпадающий список с вариантами Low, Medium, High (в стиле Jira).

---

## Персистенция

- Тот же ключ localStorage, что и в 001 (`todo-app-tasks`). Значение: JSON-массив задач; каждая задача включает поле `priority` (строка).
- При чтении: если у элемента массива нет `priority` или значение не из `['Low','Medium','High']`, подставлять `'Medium'`.
- Запись: после каждой мутации (addTask, toggleTask, setPriority, reorderTasks в рамках группы) сериализовать полный массив и записать в localStorage.

---

## Валидация (из требований)

- **FR-006**: Новые задачи получают приоритет по умолчанию Medium.
- **FR-007**: При смене приоритета задача помещается в конец новой группы.
- При вызове `setPriority(id, value)`: если `value` не из допустимого множества — no-op; иначе обновить задачу и пересчитать её `order` в новой группе (конец группы).
