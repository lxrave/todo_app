# Модель данных: E2E-сценарии и состояние приложения

Контекст: автоматические проверки Todo App в headless-браузере. Модель описывает сущности, с которыми работают E2E-сценарии, а не внутреннюю модель данных приложения (она задана в `001-todo-list/data-model.md`).

## Сущности E2E

### Сценарий проверки (Test Scenario)

Логическая единица автоматической проверки; выполняется в headless-браузере и даёт результат «успех» или «ошибка».

| Атрибут    | Описание |
|-----------|----------|
| Идентификатор | Уникальное имя сценария (например, `todo-add`, `todo-toggle`, `todo-persistence`) |
| Шаги       | Последовательность действий (открыть URL, ввод, клик, перезагрузка) |
| Ожидаемый результат | Условие успеха (появление элемента, изменение текста/статуса, сохранение после reload) |
| Зависимости | Опционально: от наличия функции в приложении (например, сценарий удаления — от реализации удаления) |

Сценарии из спецификации:
- **todo-add**: добавление задачи → появление задачи в списке.
- **todo-toggle**: переключение статуса задачи → изменение отображения (выполнена/не выполнена).
- **todo-delete**: удаление задачи → исчезновение из списка (при наличии функции в приложении).
- **todo-persistence**: добавление/переключение (и при наличии — удаление) → перезагрузка страницы → состояние списка сохраняется.

### Состояние приложения (App State Under Test)

То, что E2E наблюдает и проверяет в UI и при необходимости в localStorage.

| Атрибут        | Описание |
|----------------|----------|
| Список задач   | Набор элементов в UI (текст, статус выполнен/не выполнен); порядок при необходимости |
| Форма ввода   | Поле ввода текста задачи и кнопка добавления; доступность/недоступность кнопки |
| localStorage  | Ключ `todo-app-tasks`; после перезагрузки содержимое должно соответствовать ожидаемому состоянию списка |

Валидация в E2E:
- Наличие элемента списка с заданным текстом.
- Отображение статуса (например, зачёркнутый текст или отмеченный чекбокс для «выполнена»).
- После перезагрузки — те же задачи и статусы (проверка через повторное отображение в UI).

## Состояния сценария

- **Не запущен**: сценарий не выполнялся в текущем прогоне.
- **Выполняется**: шаги выполняются в браузере.
- **Успех**: все проверки пройдены.
- **Ошибка**: таймаут, элемент не найден, ассерт не выполнен — тест падает с явным сообщением.

## Граничные случаи (из спецификации)

- **Пустой начальный список**: успех — сценарий добавляет задачу и проверяет появление; при проверке персистентности — начальное состояние пустое, затем добавляем и проверяем после reload.
- **localStorage недоступен**: вне скоупа текущей фичи (E2E предполагают нормальную среду браузера); при необходимости можно добавить сценарий с отключённым storage позже.
- **Удаление не реализовано**: сценарий удаления помечается как skip или не добавляется до появления функции в приложении.
